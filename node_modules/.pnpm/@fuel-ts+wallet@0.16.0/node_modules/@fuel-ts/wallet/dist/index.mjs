var L=Object.defineProperty;var P=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(o,t)=>(typeof require!="undefined"?require:o)[t]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var N=(i,o)=>()=>(i&&(o=i(i=0)),o);var W=(i,o)=>{for(var t in o)L(i,t,{get:o[t],enumerable:!0})};var n=N(()=>{});n();n();import{NativeAssetId as l}from"@fuel-ts/constants";import{hashMessage as K,hashTransaction as q}from"@fuel-ts/hasher";import{HDWallet as v}from"@fuel-ts/hdwallet";import{AbstractWallet as E}from"@fuel-ts/interfaces";import{Mnemonic as F}from"@fuel-ts/mnemonic";import{ScriptTransactionRequest as B,transactionRequestify as h,Provider as U}from"@fuel-ts/providers";import{Signer as S}from"@fuel-ts/signer";import{MAX_GAS_PER_TX as C}from"@fuel-ts/transactions";var D="http://127.0.0.1:4000/graphql",u=class extends E{constructor(t,e=D){super();let r=new S(t);this.signer=()=>r,this.provider=this.connect(e)}get address(){return this.signer().address}get privateKey(){return this.signer().privateKey}get publicKey(){return this.signer().publicKey}connect(t){if(t)typeof t=="string"?this.provider=new U(t):this.provider=t;else throw new Error("Provider is required");return this.provider}signMessage(t){return this.signer().sign(K(t))}signTransaction(t){let e=h(t),r=q(e);return this.signer().sign(r)}populateTransactionWitnessesSignature(t){let e=h(t),r=e.getCoinInputWitnessIndexByOwner(this.address);if(typeof r=="number"){let s=this.signTransaction(e);e.updateWitness(r,s)}return e}async getCoinsToSpend(t,e,r){return this.provider.getCoinsToSpend(this.address,t,e,r)}async getCoins(){let t=[],r;for(;;){let s=await this.provider.getCoins(this.address,void 0,{first:9999,after:r});if(t.push(...s),!(s.length>=9999))break;throw new Error(`Wallets with more than ${9999} coins are not yet supported`)}return t}async getBalance(t=l){return await this.provider.getBalance(this.address,t)}async getBalances(){let t=[],r;for(;;){let s=await this.provider.getBalances(this.address,{first:9999,after:r});if(t.push(...s),!(s.length>=9999))break;throw new Error(`Wallets with more than ${9999} balances are not yet supported`)}return t}async fund(t){let e=t.calculateFee(),r=await this.getCoinsToSpend([e]);t.addCoins(r)}async transfer(t,e,r=l,s={}){let c={gasLimit:C,...s},a=new B(c);a.addCoinOutput(t,e,r);let f=await this.getCoinsToSpend([[e,r],a.calculateFee()]);return a.addCoins(f),this.sendTransaction(a)}async sendTransaction(t){let e=h(t);return this.provider.sendTransaction(this.populateTransactionWitnessesSignature(e))}async simulateTransaction(t){let e=h(t);return this.provider.call(this.populateTransactionWitnessesSignature(e),{utxoValidation:!0})}async buildPredicateTransaction(t,e,r=l,s){let c={fundTransaction:!0,...s},a=new B({gasLimit:C,...c});a.addCoinOutput(t,e,r);let f=[];if(c.fundTransaction&&f.push(a.calculateFee()),f.length){let k=await this.getCoinsToSpend(f);a.addCoins(k)}return a}async submitPredicate(t,e,r=l,s){let c=await this.buildPredicateTransaction(t,e,r,s);return(await this.sendTransaction(c)).waitForResult()}async submitSpendPredicate(t,e,r,s=l,c){return this.provider.submitSpendPredicate(t,e,this.address,r,s,c)}static generate(t){let e=S.generatePrivateKey(t==null?void 0:t.entropy);return new u(e,t==null?void 0:t.provider)}static fromSeed(t,e){let s=v.fromSeed(t).derivePath(e||u.defaultPath);return new u(s.privateKey)}static fromMnemonic(t,e,r){let s=F.mnemonicToSeed(t,r),a=v.fromSeed(s).derivePath(e||u.defaultPath);return new u(a.privateKey)}static fromExtendedKey(t){let e=v.fromExtendedKey(t);return new u(e.privateKey)}},m=u;m.defaultPath="m/44'/1179993420'/0'/0/0";var A={};W(A,{generateTestWallet:()=>G,seedWallet:()=>R});n();n();n();n();n();import{arrayify as st}from"@ethersproject/bytes";n();var T,w="Node";typeof globalThis<"u"&&globalThis.crypto&&(T=globalThis.crypto,w="Web");if(!T&&typeof P=="function")try{T=P("crypto"),w="Node"}catch(i){console.error("keystore expects a standard Web browser or Node environment.",i)}var y=T,b=w;n();var g=i=>b==="Node"?y.randomBytes(i):y.getRandomValues(new Uint8Array(i));n();import{coinQuantityfy as z,ScriptTransactionRequest as O}from"@fuel-ts/providers";var R=async(i,o)=>{let t=new m(process.env.GENESIS_SECRET||g(32),i.provider),e=await t.getCoinsToSpend(o),r=new O({gasLimit:1e4,gasPrice:1});r.addCoins(e),o.map(z).forEach(({amount:c,assetId:a})=>r.addCoinOutput(i.address,c,a)),await(await t.sendTransaction(r)).wait()},G=async(i,o)=>{let t=m.generate({provider:i});return o&&await R(t,o),t};export{A as TestUtils,m as Wallet};
//# sourceMappingURL=index.mjs.map